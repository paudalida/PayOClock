<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<div class="main-content">
    <mat-tab-group>
        <mat-tab label="Pending Requests">
            <div class="table-content">
                <div class="table-head">
        
                    <div class="header-text">
                        <h1> Pending Requests </h1>
                    </div>
                </div>
        
                <div class="mat-elevation-z8">
                    <table mat-table [dataSource]="pendingRequests" matSort>
                        
                        <!-- Employee Name Column -->
                        <ng-container matColumnDef="name">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Employee Name </th>
                            <td mat-cell *matCellDef="let element"> 
                                {{ element.full_name }}
                            </td>
                        </ng-container>
                
                        <!-- ID Number Column -->
                        <ng-container matColumnDef="employee_id">
                            <th mat-header-cell *matHeaderCellDef> ID Number </th>
                            <td mat-cell *matCellDef="let element"> 
                                {{ element.employee_id }} 
                            </td>
                        </ng-container>
                
                        <!-- Type of Request Column -->
                        <ng-container matColumnDef="request_type">
                            <th mat-header-cell *matHeaderCellDef> Type of Request </th>
                            <td mat-cell *matCellDef="let element"> 
                                {{ element.request_type }} 
                            </td>
                        </ng-container>
                
                        <!-- Reason Column -->
                        <ng-container matColumnDef="reason">
                            <th mat-header-cell *matHeaderCellDef> Reason </th>
                            <td mat-cell *matCellDef="let element"> 
                                {{ element.reason }} 
                            </td>
                        </ng-container>
                
                        <!-- Status Column -->
                        <ng-container matColumnDef="status">
                            <th mat-header-cell *matHeaderCellDef> Status </th>
                            <td mat-cell *matCellDef="let element"> 
                                <span [ngClass]="{
                                    'status-approved': element.status === 'Approved',
                                    'status-pending': element.status === 'Pending',
                                    'status-denied': element.status === 'Denied', 
                                    'status-cancelled': element.status == 'Cancelled'
                                }">
                                    {{ element.status }}
                                </span>
                            </td>
                        </ng-container>


                        <!-- Proof Column -->
                        <ng-container matColumnDef="proof">
                            <th mat-header-cell *matHeaderCellDef> Proof </th>
                            <td mat-cell *matCellDef="let element">
                            <div *ngIf="element.proofs?.length > 0">
                                <a *ngFor="let proof of element.proofs" [href]="proof.url" download class="proof-link">{{ proof.name }}</a>
                            </div>
                            <div *ngIf="!element.proofs?.length">
                                No files uploaded
                            </div>
                            </td>
                        </ng-container>
  
        
                        <!-- Action Column -->
                        <ng-container matColumnDef="action">
                            <th mat-header-cell *matHeaderCellDef> Action </th>
                            <td mat-cell *matCellDef="let element">
                                <div class="action-buttons">
                                    <!-- <button mat-button class="action-button view-button" (click)="viewRequest()">
                                        <i class='bx bx-show'></i>
                                    </button> -->
                                    <button mat-button class="action-button approve-button" (click)="approveRequest(element)">
                                        <i class='bx bx-check'></i> 
                                    </button>
                                    <button mat-button class="action-button deny-button" (click)="denyRequest(element)">
                                        <i class='bx bx-x'></i>
                                    </button>
                                </div>
                            </td>
                        </ng-container>
        
        
                        <tr mat-header-row *matHeaderRowDef="pendingColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns: pendingColumns;"></tr>
                    </table>
                
                    <mat-paginator [pageSizeOptions]="[5, 10, 15]" showFirstLastButtons
                        aria-label="Select page of periodic elements">
                    </mat-paginator>
                </div>        
            </div>
        </mat-tab>

        <mat-tab label="Finished Requests">
            <div class="table-content1">
                <div class="table-head">
        
                    <div class="header-text">
                        <h1> Finished Requests </h1>
                    </div>
        
                    <div class="header-dropdown"> 
                        <select class="dropdown">
                            <option value="all">All Requests</option>
                            <option value="pending">Approved</option>
                            <option value="rejected">Denied</option>
                            <option value="rejected">Cancelled</option>
                        </select>
                    </div>
                </div>
        
                <div class="mat-elevation-z8">
                    <table mat-table [dataSource]="finishedRequests" matSort>
                        
                        <!-- Employee Name Column -->
                        <ng-container matColumnDef="name">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Employee Name </th>
                            <td mat-cell *matCellDef="let element"> 
                                {{ element.full_name }}
                            </td>
                        </ng-container>
                
                        <!-- ID Number Column -->
                        <ng-container matColumnDef="employee_id">
                            <th mat-header-cell *matHeaderCellDef> ID Number </th>
                            <td mat-cell *matCellDef="let element"> 
                                {{ element.employee_id }} 
                            </td>
                        </ng-container>
                
                        <!-- Type of Request Column -->
                        <ng-container matColumnDef="request_type">
                            <th mat-header-cell *matHeaderCellDef> Type of Request </th>
                            <td mat-cell *matCellDef="let element"> 
                                {{ element.request_type }} 
                            </td>
                        </ng-container>
                
                        <!-- Reason Column -->
                        <ng-container matColumnDef="reason">
                            <th mat-header-cell *matHeaderCellDef> Reason </th>
                            <td mat-cell *matCellDef="let element"> 
                                {{ element.reason }} 
                            </td>
                        </ng-container>
                
                        <!-- Status Column -->
                        <ng-container matColumnDef="status">
                            <th mat-header-cell *matHeaderCellDef> Status </th>
                            <td mat-cell *matCellDef="let element"> 
                                <span [ngClass]="{
                                    'status-approved': element.status === 'Approved',
                                    'status-denied': element.status === 'Denied', 
                                    'status-cancelled': element.status == 'Cancelled'
                                }">
                                    {{ element.status }}
                                </span>
                            </td>
                        </ng-container>

                        <!-- Proof Column -->
                        <ng-container matColumnDef="proof">
                            <th mat-header-cell *matHeaderCellDef> Proof </th>
                            <td mat-cell *matCellDef="let element">
                            <div *ngIf="element.proofs?.length > 0">
                                <a *ngFor="let proof of element.proofs" [href]="proof.url" download class="proof-link">{{ proof.name }}</a>
                            </div>
                            <div *ngIf="!element.proofs?.length">
                                No files uploaded
                            </div>
                            </td>
                        </ng-container>
        
                        <tr mat-header-row *matHeaderRowDef="finishedColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns: finishedColumns;"></tr>
                        
                    </table>
                
                    <mat-paginator [pageSizeOptions]="[5, 10, 15]" showFirstLastButtons
                        aria-label="Select page of periodic elements">
                    </mat-paginator>
                </div>        
            </div>
        </mat-tab>
    </mat-tab-group>
</div>